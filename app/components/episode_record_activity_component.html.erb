<div class="c-timeline__episode-record-activity">
  <div class="row mb-2">
    <div class="col-auto pr-0">
      <%= link_to user_path(activity_group.user.username) do %>
        <%= render ProfileImageComponent.new(
            image_url_1x: activity_group.user.avatar_url,
            alt: "@#{activity_group.user.username}"
        ) %>
      <% end %>
    </div>

    <div class="col">
      <span class="c-timeline__user-name">
        <%= link_to activity_group.user.name, user_path(activity_group.user.username), class: "text-body font-weight-bold u-link" %>
      </span>

      <small class="mr-1">
        <%= t "messages._components.activities.episode_record.created" %>
      </small>

      <c-relative-time class="small text-muted" time="<%= activity_group.created_at %>"></c-relative-time>
    </div>
  </div>

  <% if activity_group.single %>
    <div>
      <% if episode_records.first.rating_state %>
        <c-rating-label class="mb-1" init-kind="<%= episode_records.first.rating_state.downcase %>"></c-rating-label>
      <% end %>

      <%= episode_records.first.body_html.html_safe %>
    </div>
  <% end %>

  <% episode_records.each do |episode_record| %>
    <div class="card col-11 col-lg-10 mb-2 px-0">
      <div class="card-body p-2">
        <div class="row">
          <div class="col-auto pr-0">
            <%= link_to work_path(episode_record.work.id) do %>
              <%= render WorkImageComponent.new(
                  image_url_1x: episode_record.work.image_url_1x,
                  image_url_2x: episode_record.work.image_url_2x,
                  alt: episode_record.work.local_title
              ) %>
            <% end %>
          </div>

          <div class="col">
            <div class="mb-1">
              <%= link_to episode_record.work.local_title, work_path(episode_record.work.id), class: "d-block" %>

              <%= link_to work_episode_path(episode_record.work.id, episode_record.episode.id), class: "d-block small" do %>
                <span class="pr-1">
                  <%= episode_record.episode.number_text %>
                </span>

                <%= episode_record.episode.local_title %>
              <% end %>
            </div>

            <c-status-selector :work-id="<%= episode_record.work.id %>" page-category="user-home" class="c-status-selector--small"></c-status-selector>
          </div>
        </div>
      </div>
    </div>

    <div class="mb-3">
      <c-like-button
        :init-likes-count="<%= episode_record.likes_count %>"
        :is-signed-in="true"
        :resource-id="<%= episode_record.id %>"
        class="u-fake-link mr-3"
        page-category="user-home"
        resource-name="EpisodeRecord"
      ></c-like-button>

      <%= link_to record_path(activity_group.user.username, episode_record.record.id) do %>
        <i class="far fa-comment"></i>
        <%= episode_record.comments_count %>
      <% end %>
    </div>
  <% end %>
</div>
