<div
  class="c-sidebar h-100"
  data-controller="sidebar user-data-fetcher--sidebar"
  data-user-data-fetcher--sidebar-url-value="<%= my_sidebar_path %>"
>
  <div class="c-sidebar__background" data-action="click->sidebar#hide"></div>

  <div class="c-sidebar__content">
    <%= link_to root_path, class: "c-sidebar__logo d-inline-block mb-3 text-center u-bg-mizuho w-100" do %>
      <%= image_tag(
        "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1 1'%3E%3C/svg%3E",
        alt: "Annict",
        class: "js-lazy",
        data: { src: helpers.asset_bundle_url("images/logos/color-white.png") },
        size: "25x30"
      ) %>
    <% end %>

    <div class="mb-3 px-3">
      <div
        data-user-data-fetcher--sidebar-target="replacement"
        id="c-sidebar__profile-info"
      >
        <div class="c-skeleton-loader row">
          <div class="col-3 pr-0">
            <%= helpers.skeleton_loader_content(size: "44x44", class_name: "rounded-circle") %>
          </div>
          <div class="col-auto">
            <%= helpers.skeleton_loader_content(size: "81x22") %>
            <%= helpers.skeleton_loader_content(size: "81x18") %>
          </div>
        </div>
      </div>
    </div>

    <div class="mb-3 px-1">
      <%= form_with html: { autocomplete: "off", method: :get }, local: true, url: search_path do %>
        <%= text_field_tag "q", @search.q, class: "form-control", placeholder: t("messages._common.search_with_keywords") %>
      <% end %>
    </div>

    <ul class="list-unstyled px-3">
      <li>
        <%= link_to root_path, class: "d-flex justify-content-between py-2" do %>
          <div class="c-sidebar__icon mr-1 text-center text-muted">
            <i class="fas fa-home"></i>
          </div>

          <div class="flex-grow-1 text-body">
            <%= t "noun.home" %>
          </div>
        <% end %>
      </li>

      <li
        data-user-data-fetcher--sidebar-target="replacement"
        id="c-sidebar__profile-link"
      >
        <%= link_to sign_in_path, class: "d-flex justify-content-between py-2" do %>
          <div class="c-sidebar__icon mr-1 text-center text-muted">
            <i class="fas fa-user"></i>
          </div>

          <div class="flex-grow-1 text-body">
            <%= t "noun.profile" %>
          </div>
        <% end %>
      </li>

      <li>
        <%= link_to notifications_path, class: "d-flex justify-content-between py-2" do %>
          <div class="c-sidebar__icon mr-1 text-center text-muted">
            <i class="fas fa-bell"></i>
          </div>

          <div class="flex-grow-1 text-body">
            <%= t "head.title.notifications.index" %>
          </div>

          <div
            data-user-data-fetcher--sidebar-target="replacement"
            id="c-sidebar__notifications-count"
          ></div>
        <% end %>
      </li>

      <li>
        <%= link_to "/track", class: "d-flex justify-content-between py-2" do %>
          <div class="c-sidebar__icon mr-1 text-center text-muted">
            <i class="fas fa-tasks"></i>
          </div>

          <div class="flex-grow-1 text-body">
            <%= t "verb.track" %>
          </div>
        <% end %>
      </li>
    </ul>

    <div class="font-weight-bold mb-3 px-3 small text-secondary">
      <%= t "noun.library" %>
    </div>

    <ul
      class="list-unstyled px-3"
      data-user-data-fetcher--sidebar-target="replacement"
      id="c-sidebar__library-links"
    >
      <% [
        [:watching, "play", t("noun.watching")],
        [:wanna_watch, "circle", t("noun.plan_to_watch")],
        [:watched, "check", t("noun.completed")],
        [:on_hold, "pause", t("noun.on_hold")],
        [:stop_watching, "stop", t("noun.dropped")]
      ].each do |status_kind, icon_name, link_text| %>
        <li>
          <%= link_to sign_in_path, class: "d-flex justify-content-between py-2" do %>
            <div class="c-sidebar__icon mr-1 text-center text-muted">
              <i class="fas fa-<%= icon_name %>"></i>
            </div>

            <div class="flex-grow-1 text-body">
              <%= link_text %>
            </div>
          <% end %>
        </li>
      <% end %>
    </ul>

    <div class="font-weight-bold mb-3 px-3 small text-secondary">
      <%= t "verb.explore" %>
    </div>

    <ul class="list-unstyled px-3">
      <% [
        [ENV.fetch("ANNICT_CURRENT_SEASON"), Season.current.icon_name, t("noun.current_season")],
        [ENV.fetch("ANNICT_NEXT_SEASON"), Season.next.icon_name, t("noun.next_season")],
        [ENV.fetch("ANNICT_PREVIOUS_SEASON"), Season.prev.icon_name, t("noun.previous_season")],
        [:popular, "fire-alt", t("head.title.works.popular")],
        [:newest, "bolt", t("head.title.works.newest")]
      ].each do |page_type, icon_name, link_text| %>
        <li>
          <%= link_to "/works/#{page_type}", class: "d-flex justify-content-between py-2" do %>
            <div class="c-sidebar__icon mr-1 text-center text-muted">
              <i class="fas fa-<%= icon_name %>"></i>
            </div>

            <div class="flex-grow-1 text-body">
              <%= link_text %>
            </div>
          <% end %>
        </li>
      <% end %>
    </ul>

    <div class="font-weight-bold mb-3 px-3 small text-secondary">
      Misc
    </div>

    <ul class="list-unstyled px-3">
      <% [
        [friends_path, "search", t("head.title.friends.index")],
        [channels_path, "tv", t("head.title.channels.index")],
        [profile_setting_path, "cog", t("noun.settings")],
        [faqs_path, "question-circle", t("head.title.faqs.index")],
        [about_path, "info-circle", t("head.title.pages.about")]
      ].each do |link_path, icon_name, link_text| %>
        <li>
          <%= link_to link_path, class: "d-flex justify-content-between py-2" do %>
            <div class="c-sidebar__icon mr-1 text-center text-muted">
              <i class="fas fa-<%= icon_name %>"></i>
            </div>

            <div class="flex-grow-1 text-body">
              <%= link_text %>
            </div>
          <% end %>
        </li>
      <% end %>
    </ul>

    <div class="font-weight-bold mb-3 px-3 small text-secondary">
      <%= t "noun.services" %>
    </div>

    <ul class="list-unstyled px-3">
      <% [
        [userland_root_path, "satellite-dish", t("noun.annict_userland")],
        [forum_root_path, "comments", t("noun.annict_forum")],
        [db_root_path, "database", t("noun.annict_db")],
        [supporters_path, "fan", t("noun.annict_supporters")]
      ].each do |link_path, icon_name, link_text| %>
        <li>
          <%= link_to link_path, class: "d-flex justify-content-between py-2" do %>
            <div class="c-sidebar__icon mr-1 text-center text-muted">
              <i class="fas fa-<%= icon_name %>"></i>
            </div>

            <div class="flex-grow-1 text-body">
              <%= link_text %>
            </div>
          <% end %>
        </li>
      <% end %>

      <li>
        <%= link_to "https://developers.annict.jp", class: "d-flex justify-content-between py-2", rel: "noopener", target: "_blank" do %>
          <div class="c-sidebar__icon mr-1 text-center text-muted">
            <i class="fas fa-code"></i>
          </div>

          <div class="flex-grow-1 text-body">
            <%= t "noun.annict_developers" %>
          </div>
        <% end %>
      </li>
    </ul>

    <div
      data-user-data-fetcher--sidebar-target="replacement"
      id="c-sidebar__sign_out_link"
    ></div>
  </div>
</div>
